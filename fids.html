<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Departures</title>

<!-- يمنع الكاش نهائياً -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
<meta http-equiv="Pragma" content="no-cache"/>
<meta http-equiv="Expires" content="0"/>

<style>
    body { background: #001428; font-family: Arial; color: white; margin: 0; }
    .header {
        background: linear-gradient(to right, #003366, #0055a5);
        padding: 20px;
        text-align: center;
        font-size: 32px;
        font-weight: bold;
        letter-spacing: 2px;
    }
    table { width: 100%; border-collapse: collapse; font-size: 20px; }
    th {
        background: #003366;
        padding: 10px;
        color: #aad4ff;
        border-bottom: 2px solid #0055a5;
    }
    td {
        padding: 10px;
        text-align: center;
        border-bottom: 1px solid #004a80;
    }
    tr:nth-child(even) { background: #02223d; }
    tr:nth-child(odd)  { background: #012034; }

    .airline-badge {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: #fff;
        font-weight: bold;
        margin-right: 8px;
    }

    .QR { background: #7a003c; }
    .EK { background: #d71921; }
    .EY { background: #b38b00; }
    .SV { background: #006c35; }
    .FZ { background: #ff6a00; }
    .WY { background: #007c92; }
    .KU { background: #004f9f; }
    .GF { background: #c9a14a; }
    .RJ { background: #a32035; }
    .ME { background: #006f3e; }
    .MS { background: #0b3c7c; }

    .status {
        padding: 4px 10px;
        border-radius: 50px;
        font-weight: bold;
    }

    .on-time  { color: #00ff9d; border: 1px solid #00ff9d; }
    .boarding { color: #4db8ff; border: 1px solid #4db8ff; }
    .delayed  { color: #ff6b6b; border: 1px solid #ff6b6b; }
    .last-call { color: #ffd166; border: 1px solid #ffd166; }
</style>
</head>

<body>

<div class="header">DEPARTURES</div>

<table>
    <thead>
        <tr>
            <th>Airline</th>
            <th>Flight</th>
            <th>Destination</th>
            <th>Time</th>
            <th>Gate</th>
            <th>Status</th>
        </tr>
    </thead>

    <tbody id="flights-table"></tbody>
</table>

<script>
const DATA_URL = "https://raw.githubusercontent.com/majdbawab/fids-data/main/flights.json";

function loadFlights() {
    fetch(DATA_URL + "?t=" + Date.now(), { cache: "no-store" })
        .then(res => res.json())
        .then(flights => {
            const table = document.getElementById("flights-table");
            table.innerHTML = "";

            flights.forEach(f => {
                table.innerHTML += `
                    <tr>
                        <td>
                            <span class="airline-badge ${f.airline}">${f.airline}</span>
                            ${f.name}
                        </td>
                        <td>${f.flight}</td>
                        <td>${f.dest}</td>
                        <td>${f.time}</td>
                        <td>${f.gate}</td>
                        <td><span class="status ${f.status}">${formatStatus(f.status)}</span></td>
                    </tr>
                `;
            });
        })
        .catch(err => console.error("Error loading JSON", err));
}

function formatStatus(s) {
    const statuses = {
        "on-time": "On Time",
        "boarding": "Boarding",
        "delayed": "Delayed",
        "last-call": "Last Call"
    };
    return statuses[s] || s;
}

loadFlights();

// تحديث كل 5 ثواني بدل 60 ثانية
setInterval(loadFlights, 5000);
</script>

</body>
</html>
